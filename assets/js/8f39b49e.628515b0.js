"use strict";(self.webpackChunksample_website=self.webpackChunksample_website||[]).push([[6043],{5680:(e,t,n)=>{n.d(t,{xA:()=>c,yg:()=>m});var a=n(6540);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},g="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),g=p(n),d=r,m=g["".concat(s,".").concat(d)]||g[d]||u[d]||o;return n?a.createElement(m,i(i({ref:t},c),{},{components:n})):a.createElement(m,i({ref:t},c))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[g]="string"==typeof e?e:r,i[1]=l;for(var p=2;p<o;p++)i[p]=n[p];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},93:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>l,toc:()=>p});var a=n(8168),r=(n(6540),n(5680));const o={title:"Server Initialization",sidebar_label:"Initialization",sidebar_position:2,slug:"/server-initialization/"},i=void 0,l={unversionedId:"categories/Server/server-initialization",id:"version-3.x/categories/Server/server-initialization",title:"Server Initialization",description:"Once you have installed the Socket.IO server library, you can now init the server. The complete list of options can be found below.",source:"@site/versioned_docs/version-3.x/categories/02-Server/server-initialization.md",sourceDirName:"categories/02-Server",slug:"/server-initialization/",permalink:"/docs/v3/server-initialization/",draft:!1,editUrl:"https://github.com/socketio/socket.io-website/edit/main/versioned_docs/version-3.x/categories/02-Server/server-initialization.md",tags:[],version:"3.x",lastUpdatedAt:1631601618,formattedLastUpdatedAt:"Sep 14, 2021",sidebarPosition:2,frontMatter:{title:"Server Initialization",sidebar_label:"Initialization",sidebar_position:2,slug:"/server-initialization/"},sidebar:"version-3.x/sidebar",previous:{title:"Troubleshooting",permalink:"/docs/v3/troubleshooting-connection-issues/"},next:{title:"Installation",permalink:"/docs/v3/server-installation/"}},s={},p=[{value:"Syntax",id:"syntax",level:2},{value:"CommonJS",id:"commonjs",level:3},{value:"ES modules",id:"es-modules",level:3},{value:"TypeScript",id:"typescript",level:3},{value:"Initialization",id:"initialization",level:2},{value:"Standalone",id:"standalone",level:3},{value:"Attached to an existing HTTP server",id:"attached-to-an-existing-http-server",level:3},{value:"With an HTTP server",id:"with-an-http-server",level:4},{value:"With an HTTPS server",id:"with-an-https-server",level:4},{value:"With an HTTP/2 server",id:"with-an-http2-server",level:4},{value:"With Express",id:"with-express",level:3},{value:"With Koa",id:"with-koa",level:3},{value:"Options",id:"options",level:2},{value:"Socket.IO server options",id:"socketio-server-options",level:3},{value:"<code>path</code>",id:"path",level:4},{value:"<code>serveClient</code>",id:"serveclient",level:4},{value:"<code>adapter</code>",id:"adapter",level:4},{value:"<code>parser</code>",id:"parser",level:4},{value:"<code>connectTimeout</code>",id:"connecttimeout",level:4},{value:"Low-level engine options",id:"low-level-engine-options",level:3},{value:"<code>pingTimeout</code>",id:"pingtimeout",level:4},{value:"<code>pingInterval</code>",id:"pinginterval",level:4},{value:"<code>upgradeTimeout</code>",id:"upgradetimeout",level:4},{value:"<code>maxHttpBufferSize</code>",id:"maxhttpbuffersize",level:4},{value:"<code>allowRequest</code>",id:"allowrequest",level:4},{value:"<code>transports</code>",id:"transports",level:4},{value:"<code>allowUpgrades</code>",id:"allowupgrades",level:4},{value:"<code>perMessageDeflate</code>",id:"permessagedeflate",level:4},{value:"<code>httpCompression</code>",id:"httpcompression",level:4},{value:"<code>wsEngine</code>",id:"wsengine",level:4},{value:"<code>cors</code>",id:"cors",level:4},{value:"<code>cookie</code>",id:"cookie",level:4},{value:"<code>allowEIO3</code>",id:"alloweio3",level:4}],c={toc:p},g="wrapper";function u(e){let{components:t,...n}=e;return(0,r.yg)(g,(0,a.A)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.yg)("p",null,"Once you have ",(0,r.yg)("a",{parentName:"p",href:"/docs/v3/server-installation/"},"installed")," the Socket.IO server library, you can now init the server. The complete list of options can be found ",(0,r.yg)("a",{parentName:"p",href:"#Options"},"below"),"."),(0,r.yg)("h2",{id:"syntax"},"Syntax"),(0,r.yg)("h3",{id:"commonjs"},"CommonJS"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},'const httpServer = require("http").createServer();\nconst io = require("socket.io")(httpServer, {\n  // ...\n});\n\nio.on("connection", (socket) => {\n  // ...\n});\n\nhttpServer.listen(3000);\n')),(0,r.yg)("h3",{id:"es-modules"},"ES modules"),(0,r.yg)("p",null,"Please see ",(0,r.yg)("a",{parentName:"p",href:"https://nodejs.org/api/esm.html#esm_enabling"},"here")," for enabling ECMAScript modules in your Node.js project."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},'import { createServer } from "http";\nimport { Server } from "socket.io";\n\nconst httpServer = createServer();\nconst io = new Server(httpServer, {\n  // ...\n});\n\nio.on("connection", (socket) => {\n  // ...\n});\n\nhttpServer.listen(3000);\n')),(0,r.yg)("h3",{id:"typescript"},"TypeScript"),(0,r.yg)("p",null,"Socket.IO has now first-class support for TypeScript:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-ts"},'import { createServer } from "http";\nimport { Server, Socket } from "socket.io";\n\nconst httpServer = createServer();\nconst io = new Server(httpServer, {\n  // ...\n});\n\nio.on("connection", (socket: Socket) => {\n  // ...\n});\n\nhttpServer.listen(3000);\n')),(0,r.yg)("h2",{id:"initialization"},"Initialization"),(0,r.yg)("h3",{id:"standalone"},"Standalone"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},'const options = { /* ... */ };\nconst io = require("socket.io")(options);\n\nio.on("connection", socket => { /* ... */ });\n\nio.listen(3000);\n')),(0,r.yg)("p",null,"You can also pass the port as the first argument:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},'const options = { /* ... */ };\nconst io = require("socket.io")(3000, options);\n\nio.on("connection", socket => { /* ... */ });\n')),(0,r.yg)("p",null,"This implicitly starts a Node.js ",(0,r.yg)("a",{parentName:"p",href:"https://nodejs.org/docs/latest/api/http.html#http_class_http_server"},"HTTP server"),", which can be accessed through ",(0,r.yg)("inlineCode",{parentName:"p"},"io.httpServer"),"."),(0,r.yg)("h3",{id:"attached-to-an-existing-http-server"},"Attached to an existing HTTP server"),(0,r.yg)("h4",{id:"with-an-http-server"},"With an HTTP server"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},'const httpServer = require("http").createServer();\nconst options = { /* ... */ };\nconst io = require("socket.io")(httpServer, options);\n\nio.on("connection", socket => { /* ... */ });\n\nhttpServer.listen(3000);\n')),(0,r.yg)("h4",{id:"with-an-https-server"},"With an HTTPS server"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},'const fs = require("fs");\nconst httpServer = require("https").createServer({\n  key: fs.readFileSync("/tmp/key.pem"),\n  cert: fs.readFileSync("/tmp/cert.pem")\n});\nconst options = { /* ... */ };\nconst io = require("socket.io")(httpServer, options);\n\nio.on("connection", socket => { /* ... */ });\n\nhttpServer.listen(3000);\n')),(0,r.yg)("p",null,(0,r.yg)("a",{parentName:"p",href:"https://nodejs.org/api/https.html#https_https_createserver_options_requestlistener"},"Node.js documentation")),(0,r.yg)("h4",{id:"with-an-http2-server"},"With an HTTP/2 server"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},'const fs = require("fs");\nconst httpServer = require("http2").createSecureServer({\n  allowHTTP1: true,\n  key: fs.readFileSync("/tmp/key.pem"),\n  cert: fs.readFileSync("/tmp/cert.pem")\n});\nconst options = { /* ... */ };\nconst io = require("socket.io")(httpServer, options);\n\nio.on("connection", socket => { /* ... */ });\n\nhttpServer.listen(3000);\n')),(0,r.yg)("p",null,(0,r.yg)("a",{parentName:"p",href:"https://nodejs.org/api/http2.html#http2_http2_createsecureserver_options_onrequesthandler"},"Node.js documentation")),(0,r.yg)("h3",{id:"with-express"},"With Express"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},'const app = require("express")();\nconst httpServer = require("http").createServer(app);\nconst options = { /* ... */ };\nconst io = require("socket.io")(httpServer, options);\n\nio.on("connection", socket => { /* ... */ });\n\nhttpServer.listen(3000);\n// WARNING !!! app.listen(3000); will not work here, as it creates a new HTTP server\n')),(0,r.yg)("p",null,"More information ",(0,r.yg)("a",{parentName:"p",href:"http://expressjs.com/"},"here"),"."),(0,r.yg)("h3",{id:"with-koa"},"With Koa"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},'const app = require("koa")();\nconst httpServer = require("http").createServer(app.callback());\nconst options = { /* ... */ };\nconst io = require("socket.io")(httpServer, options);\n\nio.on("connection", socket => { /* ... */ });\n\nhttpServer.listen(3000);\n')),(0,r.yg)("p",null,"More information ",(0,r.yg)("a",{parentName:"p",href:"https://koajs.com/"},"here"),"."),(0,r.yg)("h2",{id:"options"},"Options"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"#Socket-IO-server-options"},"Socket.IO server options"),(0,r.yg)("ul",{parentName:"li"},(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"#path"},"path")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"#serveClient"},"serveClient")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"#adapter"},"adapter")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"#parser"},"parser")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"#connectTimeout"},"connectTimeout")))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"#Low-level-engine-options"},"Low-level engine options"),(0,r.yg)("ul",{parentName:"li"},(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"#pingTimeout"},"pingTimeout")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"#pingInterval"},"pingInterval")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"#upgradeTimeout"},"upgradeTimeout")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"#maxHttpBufferSize"},"maxHttpBufferSize")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"#allowRequest"},"allowRequest")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"#transports"},"transports")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"#allowUpgrades"},"allowUpgrades")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"#perMessageDeflate"},"perMessageDeflate")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"#httpCompression"},"httpCompression")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"#wsEngine"},"wsEngine")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"#cors"},"cors")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"#cookie"},"cookie")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"#allowEIO3"},"allowEIO3"))))),(0,r.yg)("h3",{id:"socketio-server-options"},"Socket.IO server options"),(0,r.yg)("h4",{id:"path"},(0,r.yg)("inlineCode",{parentName:"h4"},"path")),(0,r.yg)("p",null,"Default value: ",(0,r.yg)("inlineCode",{parentName:"p"},"/socket.io/")),(0,r.yg)("p",null,"It is the name of the path that is captured on the server side."),(0,r.yg)("p",null,"The server and the client values must match (unless you are using a path-rewriting proxy in between):"),(0,r.yg)("p",null,(0,r.yg)("em",{parentName:"p"},"Server")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},'const httpServer = require("http").createServer();\nconst io = require("socket.io")(httpServer, {\n  path: "/my-custom-path/"\n});\n')),(0,r.yg)("p",null,(0,r.yg)("em",{parentName:"p"},"Client")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},'import { io } from "socket.io-client";\n\nconst socket = io("https://example.com", {\n  path: "/my-custom-path/"\n});\n')),(0,r.yg)("h4",{id:"serveclient"},(0,r.yg)("inlineCode",{parentName:"h4"},"serveClient")),(0,r.yg)("p",null,"Default value: ",(0,r.yg)("inlineCode",{parentName:"p"},"true")),(0,r.yg)("p",null,"Whether to serve the client files. If ",(0,r.yg)("inlineCode",{parentName:"p"},"true"),", the different bundles will be served at the following location:"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"<url>/socket.io/socket.io.js")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"<url>/socket.io/socket.io.min.js")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"<url>/socket.io/socket.io.msgpack.min.js"))),(0,r.yg)("p",null,"(including their associated source maps)"),(0,r.yg)("p",null,"See also ",(0,r.yg)("a",{parentName:"p",href:"/docs/v3/client-installation/#Standalone-build"},"here"),"."),(0,r.yg)("h4",{id:"adapter"},(0,r.yg)("inlineCode",{parentName:"h4"},"adapter")),(0,r.yg)("p",null,"Default value: ",(0,r.yg)("inlineCode",{parentName:"p"},"socket.io-adapter")," (in-memory adapter, whose source code can be found ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/socketio/socket.io-adapter/"},"here"),")"),(0,r.yg)("p",null,"The ",(0,r.yg)("a",{parentName:"p",href:"/docs/v3/glossary/#Adapter"},'"Adapter"')," to use."),(0,r.yg)("p",null,"Example with the Redis adapter (the ",(0,r.yg)("inlineCode",{parentName:"p"},"socket.io-redis")," package, more information ",(0,r.yg)("a",{parentName:"p",href:"/docs/v3/using-multiple-nodes/#Passing-events-between-nodes"},"here"),"):"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},'const httpServer = require("http").createServer();\nconst redisClient = require("redis").createClient();\nconst io = require("socket.io")(httpServer, {\n  adapter: require("socket.io-redis")({\n    pubClient: redisClient,\n    subClient: redisClient.duplicate()\n  })\n});\n')),(0,r.yg)("h4",{id:"parser"},(0,r.yg)("inlineCode",{parentName:"h4"},"parser")),(0,r.yg)("p",null,"Default value: ",(0,r.yg)("inlineCode",{parentName:"p"},"socket.io-parser")),(0,r.yg)("p",null,"The parser to use. Please see the documentation ",(0,r.yg)("a",{parentName:"p",href:"/docs/v3/custom-parser/"},"here"),"."),(0,r.yg)("h4",{id:"connecttimeout"},(0,r.yg)("inlineCode",{parentName:"h4"},"connectTimeout")),(0,r.yg)("p",null,"Default value: ",(0,r.yg)("inlineCode",{parentName:"p"},"45000")),(0,r.yg)("p",null,"The number of ms before disconnecting a client that has not successfully joined a namespace."),(0,r.yg)("h3",{id:"low-level-engine-options"},"Low-level engine options"),(0,r.yg)("h4",{id:"pingtimeout"},(0,r.yg)("inlineCode",{parentName:"h4"},"pingTimeout")),(0,r.yg)("p",null,"Default value: ",(0,r.yg)("inlineCode",{parentName:"p"},"5000")),(0,r.yg)("p",null,"This value is used in the heartbeat mechanism, which periodically checks if the connection is still alive between the server and the client."),(0,r.yg)("p",null,"The server sends a ping, and if the client does not answer with a pong within ",(0,r.yg)("inlineCode",{parentName:"p"},"pingTimeout")," ms, the server considers that the connection is closed."),(0,r.yg)("p",null,"Similarly, if the client does not receive a ping from the server within ",(0,r.yg)("inlineCode",{parentName:"p"},"pingInterval + pingTimeout")," ms, the client also considers that the connection is closed."),(0,r.yg)("p",null,"In both cases, the disconnection reason will be: ",(0,r.yg)("inlineCode",{parentName:"p"},"ping timeout")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},'socket.on("disconnect", (reason) => {\n  console.log(reason); // "ping timeout"\n});\n')),(0,r.yg)("p",null,"Note: the default value might be a bit low if you need to send big files in your application. Please increase it if that's the case:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},'const io = require("socket.io")(httpServer, {\n  pingTimeout: 30000\n});\n')),(0,r.yg)("h4",{id:"pinginterval"},(0,r.yg)("inlineCode",{parentName:"h4"},"pingInterval")),(0,r.yg)("p",null,"Default value: ",(0,r.yg)("inlineCode",{parentName:"p"},"25000")),(0,r.yg)("p",null,"See ",(0,r.yg)("a",{parentName:"p",href:"#pingTimeout"},"above"),"."),(0,r.yg)("h4",{id:"upgradetimeout"},(0,r.yg)("inlineCode",{parentName:"h4"},"upgradeTimeout")),(0,r.yg)("p",null,"Default value: ",(0,r.yg)("inlineCode",{parentName:"p"},"10000")),(0,r.yg)("p",null,"This is the delay in milliseconds before an uncompleted transport upgrade is cancelled."),(0,r.yg)("h4",{id:"maxhttpbuffersize"},(0,r.yg)("inlineCode",{parentName:"h4"},"maxHttpBufferSize")),(0,r.yg)("p",null,"Default value: ",(0,r.yg)("inlineCode",{parentName:"p"},"1e6")," (1 MB)"),(0,r.yg)("p",null,"This defines how many bytes a single message can be, before closing the socket. You may increase or decrease this value depending on your needs."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},'const io = require("socket.io")(httpServer, {\n  maxHttpBufferSize: 1e8\n});\n')),(0,r.yg)("p",null,"It matches the ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/websockets/ws/blob/master/doc/ws.md#new-websocketserveroptions-callback"},"maxPayload")," option of the ws package."),(0,r.yg)("h4",{id:"allowrequest"},(0,r.yg)("inlineCode",{parentName:"h4"},"allowRequest")),(0,r.yg)("p",null,"Default: ",(0,r.yg)("inlineCode",{parentName:"p"},"-")),(0,r.yg)("p",null,"A function that receives a given handshake or upgrade request as its first parameter, and can decide whether to continue or not."),(0,r.yg)("p",null,"Example:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},'const io = require("socket.io")(httpServer, {\n  allowRequest: (req, callback) => {\n    const isOriginValid = check(req);\n    callback(null, isOriginValid);\n  }\n});\n')),(0,r.yg)("h4",{id:"transports"},(0,r.yg)("inlineCode",{parentName:"h4"},"transports")),(0,r.yg)("p",null,"Default value: ",(0,r.yg)("inlineCode",{parentName:"p"},'["polling", "websocket"]')),(0,r.yg)("p",null,"The low-level transports that are allowed on the server-side."),(0,r.yg)("p",null,"See also: client-side ",(0,r.yg)("a",{parentName:"p",href:"/docs/v3/client-initialization/#transports"},(0,r.yg)("inlineCode",{parentName:"a"},"transports"))),(0,r.yg)("h4",{id:"allowupgrades"},(0,r.yg)("inlineCode",{parentName:"h4"},"allowUpgrades")),(0,r.yg)("p",null,"Default value: ",(0,r.yg)("inlineCode",{parentName:"p"},"true")),(0,r.yg)("p",null,"Whether to allow transport upgrades."),(0,r.yg)("h4",{id:"permessagedeflate"},(0,r.yg)("inlineCode",{parentName:"h4"},"perMessageDeflate")),(0,r.yg)("details",{class:"changelog"},(0,r.yg)("summary",null,"History"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"Version"),(0,r.yg)("th",{parentName:"tr",align:null},"Changes"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"v3.0.0"),(0,r.yg)("td",{parentName:"tr",align:null},"The permessage-deflate extension is now disabled by default.")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"v1.4.0"),(0,r.yg)("td",{parentName:"tr",align:null},"First implementation."))))),(0,r.yg)("p",null,"Default value: ",(0,r.yg)("inlineCode",{parentName:"p"},"false")),(0,r.yg)("p",null,"Whether to enable the ",(0,r.yg)("a",{parentName:"p",href:"https://tools.ietf.org/html/draft-ietf-hybi-permessage-compression-19"},"permessage-deflate extension")," for the WebSocket transport. This extension is known to add a significant overhead in terms of performance and memory consumption, so we suggest to only enable it if it is really needed."),(0,r.yg)("p",null,"Please note that if ",(0,r.yg)("inlineCode",{parentName:"p"},"perMessageDeflate")," is set to ",(0,r.yg)("inlineCode",{parentName:"p"},"false")," (which is the default), the compress flag used when emitting (",(0,r.yg)("inlineCode",{parentName:"p"},"socket.compress(true).emit(...)"),") will be ignored when the connection is established with WebSockets, as the permessage-deflate extension cannot be enabled on a per-message basis."),(0,r.yg)("p",null,"All options from the ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/websockets/ws/blob/master/README.md#websocket-compression"},(0,r.yg)("inlineCode",{parentName:"a"},"ws")," module")," are supported:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},'const io = require("socket.io")(httpServer, {\n  perMessageDeflate: {\n    threshold: 2048, // defaults to 1024\n\n    zlibDeflateOptions: {\n      chunkSize: 8 * 1024, // defaults to 16 * 1024\n    },\n\n    zlibInflateOptions: {\n      windowBits: 14, // defaults to 15\n      memLevel: 7, // defaults to 8\n    },\n\n    clientNoContextTakeover: true, // defaults to negotiated value.\n    serverNoContextTakeover: true, // defaults to negotiated value.\n    serverMaxWindowBits: 10, // defaults to negotiated value.\n\n    concurrencyLimit: 20, // defaults to 10\n  }\n});\n')),(0,r.yg)("h4",{id:"httpcompression"},(0,r.yg)("inlineCode",{parentName:"h4"},"httpCompression")),(0,r.yg)("span",{class:"changelog"},"Added in v1.4.0"),(0,r.yg)("p",null,"Default value: ",(0,r.yg)("inlineCode",{parentName:"p"},"true")),(0,r.yg)("p",null,"Whether to enable the compression for the HTTP long-polling transport."),(0,r.yg)("p",null,"Please note that if ",(0,r.yg)("inlineCode",{parentName:"p"},"httpCompression")," is set to ",(0,r.yg)("inlineCode",{parentName:"p"},"false"),", the compress flag used when emitting (",(0,r.yg)("inlineCode",{parentName:"p"},"socket.compress(true).emit(...)"),") will be ignored when the connection is established with HTTP long-polling requests."),(0,r.yg)("p",null,"Example:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},'const io = require("socket.io")(httpServer, {\n  httpCompression: {\n    threshold: 2048, // defaults to 1024\n\n    chunkSize: 8 * 1024, // defaults to 16 * 1024\n    windowBits: 14, // defaults to 15\n    memLevel: 7, // defaults to 8\n  }\n});\n')),(0,r.yg)("h4",{id:"wsengine"},(0,r.yg)("inlineCode",{parentName:"h4"},"wsEngine")),(0,r.yg)("p",null,"Default value: ",(0,r.yg)("inlineCode",{parentName:"p"},'"ws"')," (source code can be found ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/websockets/ws"},"here"),")"),(0,r.yg)("p",null,"The WebSocket server implementation to use. Please see the documentation ",(0,r.yg)("a",{parentName:"p",href:"/docs/v3/server-installation/#Other-WebSocket-server-implementations"},"here"),"."),(0,r.yg)("p",null,"Example:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},'const io = require("socket.io")(httpServer, {\n  wsEngine: "eiows"\n});\n')),(0,r.yg)("h4",{id:"cors"},(0,r.yg)("inlineCode",{parentName:"h4"},"cors")),(0,r.yg)("p",null,"Default value: ",(0,r.yg)("inlineCode",{parentName:"p"},"-")),(0,r.yg)("p",null,"The list of options that will be forwarded to the ",(0,r.yg)("a",{parentName:"p",href:"https://www.npmjs.com/package/cors"},(0,r.yg)("inlineCode",{parentName:"a"},"cors"))," module. More information can be found ",(0,r.yg)("a",{parentName:"p",href:"/docs/v3/handling-cors/"},"here"),"."),(0,r.yg)("p",null,"Example:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},'const io = require("socket.io")(httpServer, {\n  cors: {\n    origin: ["https://example.com", "https://dev.example.com"],\n    allowedHeaders: ["my-custom-header"],\n    credentials: true\n  }\n});\n')),(0,r.yg)("h4",{id:"cookie"},(0,r.yg)("inlineCode",{parentName:"h4"},"cookie")),(0,r.yg)("p",null,"Default value: ",(0,r.yg)("inlineCode",{parentName:"p"},"-")),(0,r.yg)("p",null,"The list of options that will be forwarded to the ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/jshttp/cookie/"},(0,r.yg)("inlineCode",{parentName:"a"},"cookie"))," module."),(0,r.yg)("p",null,"Please note that since Socket.IO v3, there is no cookie sent by default anymore (",(0,r.yg)("a",{parentName:"p",href:"/docs/v3/migrating-from-2-x-to-3-0/#No-more-cookie-by-default"},"reference"),")."),(0,r.yg)("p",null,"Example:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},'const io = require("socket.io")(httpServer, {\n  cookie: {\n    name: "my-cookie",\n    httpOnly: true,\n    sameSite: "strict",\n    maxAge: 86400\n  }\n});\n')),(0,r.yg)("h4",{id:"alloweio3"},(0,r.yg)("inlineCode",{parentName:"h4"},"allowEIO3")),(0,r.yg)("p",null,"Default value: ",(0,r.yg)("inlineCode",{parentName:"p"},"false")),(0,r.yg)("p",null,"Whether to enable compatibility with Socket.IO v2 clients."),(0,r.yg)("p",null,"See also: ",(0,r.yg)("a",{parentName:"p",href:"/docs/v3/migrating-from-2-x-to-3-0/#How-to-upgrade-an-existing-production-deployment"},"Migrating from 2.x to 3.0")),(0,r.yg)("p",null,"Example:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},'const io = require("socket.io")(httpServer, {\n  allowEIO3: true // false by default\n});\n')))}u.isMDXComponent=!0}}]);