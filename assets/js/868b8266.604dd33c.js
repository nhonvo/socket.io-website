"use strict";(self.webpackChunksample_website=self.webpackChunksample_website||[]).push([[2929],{5680:(e,n,t)=>{t.d(n,{xA:()=>c,yg:()=>y});var a=t(6540);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},l=Object.keys(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var s=a.createContext({}),p=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):r(r({},n),e)),t},c=function(e){var n=p(e.components);return a.createElement(s.Provider,{value:n},e.children)},m="mdxType",g={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},u=a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,l=e.originalType,s=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),m=p(t),u=o,y=m["".concat(s,".").concat(u)]||m[u]||g[u]||l;return t?a.createElement(y,r(r({ref:n},c),{},{components:t})):a.createElement(y,r({ref:n},c))}));function y(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var l=t.length,r=new Array(l);r[0]=u;var i={};for(var s in n)hasOwnProperty.call(n,s)&&(i[s]=n[s]);i.originalType=e,i[m]="string"==typeof e?e:o,r[1]=i;for(var p=2;p<l;p++)r[p]=t[p];return a.createElement.apply(null,r)}return a.createElement.apply(null,t)}u.displayName="MDXCreateElement"},1836:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>r,default:()=>g,frontMatter:()=>l,metadata:()=>i,toc:()=>p});var a=t(8168),o=(t(6540),t(5680));const l={title:"Client Initialization",sidebar_label:"Initialization",sidebar_position:2,slug:"/client-initialization/"},r=void 0,i={unversionedId:"categories/Client/client-initialization",id:"version-3.x/categories/Client/client-initialization",title:"Client Initialization",description:"Once you have installed the Socket.IO client library, you can now init the client. The complete list of options can be found below.",source:"@site/versioned_docs/version-3.x/categories/03-Client/client-initialization.md",sourceDirName:"categories/03-Client",slug:"/client-initialization/",permalink:"/docs/v3/client-initialization/",draft:!1,editUrl:"https://github.com/socketio/socket.io-website/edit/main/versioned_docs/version-3.x/categories/03-Client/client-initialization.md",tags:[],version:"3.x",lastUpdatedAt:1669363169,formattedLastUpdatedAt:"Nov 25, 2022",sidebarPosition:2,frontMatter:{title:"Client Initialization",sidebar_label:"Initialization",sidebar_position:2,slug:"/client-initialization/"},sidebar:"version-3.x/sidebar",previous:{title:"Installation",permalink:"/docs/v3/client-installation/"},next:{title:"The Socket instance",permalink:"/docs/v3/client-socket-instance/"}},s={},p=[{value:"From the same domain",id:"from-the-same-domain",level:2},{value:"From a different domain",id:"from-a-different-domain",level:2},{value:"Custom namespace",id:"custom-namespace",level:2},{value:"Options",id:"options",level:2},{value:"IO factory options",id:"io-factory-options",level:3},{value:"<code>forceNew</code>",id:"forcenew",level:4},{value:"<code>multiplex</code>",id:"multiplex",level:4},{value:"Low-level engine options",id:"low-level-engine-options",level:3},{value:"<code>transports</code>",id:"transports",level:4},{value:"<code>upgrade</code>",id:"upgrade",level:4},{value:"<code>rememberUpgrade</code>",id:"rememberupgrade",level:4},{value:"<code>path</code>",id:"path",level:4},{value:"<code>query</code>",id:"query",level:4},{value:"<code>extraHeaders</code>",id:"extraheaders",level:4},{value:"<code>withCredentials</code>",id:"withcredentials",level:4},{value:"<code>forceBase64</code>",id:"forcebase64",level:4},{value:"<code>timestampRequests</code>",id:"timestamprequests",level:4},{value:"<code>timestampParam</code>",id:"timestampparam",level:4},{value:"Node.js-specific options",id:"nodejs-specific-options",level:4},{value:"Manager options",id:"manager-options",level:3},{value:"reconnection",id:"reconnection",level:4},{value:"reconnectionAttempts",id:"reconnectionattempts",level:4},{value:"reconnectionDelay",id:"reconnectiondelay",level:4},{value:"reconnectionDelayMax",id:"reconnectiondelaymax",level:4},{value:"randomizationFactor",id:"randomizationfactor",level:4},{value:"timeout",id:"timeout",level:4},{value:"autoConnect",id:"autoconnect",level:4},{value:"<code>parser</code>",id:"parser",level:4},{value:"Socket options",id:"socket-options",level:3},{value:"<code>auth</code>",id:"auth",level:4}],c={toc:p},m="wrapper";function g(e){let{components:n,...l}=e;return(0,o.yg)(m,(0,a.A)({},c,l,{components:n,mdxType:"MDXLayout"}),(0,o.yg)("p",null,"Once you have ",(0,o.yg)("a",{parentName:"p",href:"/docs/v3/client-installation/"},"installed")," the Socket.IO client library, you can now init the client. The complete list of options can be found ",(0,o.yg)("a",{parentName:"p",href:"#Options"},"below"),"."),(0,o.yg)("p",null,"In the examples below, the ",(0,o.yg)("inlineCode",{parentName:"p"},"io")," object comes either from:"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"the ",(0,o.yg)("inlineCode",{parentName:"li"},"<script>")," import")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-html"},'<script src="/socket.io/socket.io.js"><\/script>\n')),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"NPM")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},'// ES6 import or TypeScript\nimport { io } from "socket.io-client";\n// CommonJS\nconst io = require("socket.io-client");\n')),(0,o.yg)("h2",{id:"from-the-same-domain"},"From the same domain"),(0,o.yg)("p",null,"If your front is served on the same domain as your server, you can simply use:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},"const socket = io();\n")),(0,o.yg)("p",null,"The server URL will be deduced from the ",(0,o.yg)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/API/Window/location"},"window.location")," object."),(0,o.yg)("h2",{id:"from-a-different-domain"},"From a different domain"),(0,o.yg)("p",null,"In case your front is not served from the same domain as your server, you have to pass the URL of your server."),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},'const socket = io("https://server-domain.com");\n')),(0,o.yg)("p",null,"In that case, please make sure to enable ",(0,o.yg)("a",{parentName:"p",href:"/docs/v3/handling-cors/"},"Cross-Origin Resource Sharing (CORS)")," on the server."),(0,o.yg)("p",null,"Note: You can use either ",(0,o.yg)("inlineCode",{parentName:"p"},"https")," or ",(0,o.yg)("inlineCode",{parentName:"p"},"wss")," (respectively, ",(0,o.yg)("inlineCode",{parentName:"p"},"http")," or ",(0,o.yg)("inlineCode",{parentName:"p"},"ws"),")."),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},'// the following forms are similar\nconst socket = io("https://server-domain.com");\nconst socket = io("wss://server-domain.com");\nconst socket = io("server-domain.com"); // only in the browser when the page is served over https (will not work in Node.js)\n')),(0,o.yg)("h2",{id:"custom-namespace"},"Custom namespace"),(0,o.yg)("p",null,"In the examples above, the client will connect to the main namespace. Using only the main namespace should be sufficient for most use cases, but you can specify the namespace with:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},'// same origin version\nconst socket = io("/admin");\n// cross origin version\nconst socket = io("https://server-domain.com/admin");\n')),(0,o.yg)("p",null,"You can find more details about namespaces ",(0,o.yg)("a",{parentName:"p",href:"/docs/v3/namespaces/"},"here"),"."),(0,o.yg)("h2",{id:"options"},"Options"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"#io-factory-options"},"IO factory options"),(0,o.yg)("ul",{parentName:"li"},(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"#forcenew"},"forceNew")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"#multiplex"},"multiplex")))),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"#low-level-engine-options"},"Low-level engine options"),(0,o.yg)("ul",{parentName:"li"},(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"#transports"},"transports")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"#upgrade"},"upgrade")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"#rememberupgrade"},"rememberUpgrade")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"#path"},"path")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"#query"},"query")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"#extraheaders"},"extraHeaders")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"#withcredentials"},"withCredentials")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"#forcebase64"},"forceBase64")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"#timestamprequests"},"timestampRequests")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"#timestampparam"},"timestampParam")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"#nodejs-specific-options"},"Node.js-specific options")," (like ",(0,o.yg)("inlineCode",{parentName:"li"},"agent"),", ",(0,o.yg)("inlineCode",{parentName:"li"},"cert")," or ",(0,o.yg)("inlineCode",{parentName:"li"},"rejectUnauthorized"),")"))),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"#manager-options"},"Manager options"),(0,o.yg)("ul",{parentName:"li"},(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"#reconnection"},"reconnection")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"#reconnectionattempts"},"reconnectionAttempts")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"#reconnectiondelay"},"reconnectionDelay")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"#reconnectiondelaymax"},"reconnectionDelayMax")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"#randomizationfactor"},"randomizationFactor")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"#timeout"},"timeout")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"#autoconnect"},"autoConnect")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"#parser"},"parser")))),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"#socket-options"},"Socket options"),(0,o.yg)("ul",{parentName:"li"},(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"#auth"},"auth"))))),(0,o.yg)("h3",{id:"io-factory-options"},"IO factory options"),(0,o.yg)("h4",{id:"forcenew"},(0,o.yg)("inlineCode",{parentName:"h4"},"forceNew")),(0,o.yg)("p",null,"Default value: ",(0,o.yg)("inlineCode",{parentName:"p"},"false")),(0,o.yg)("p",null,"Whether to create a new Manager instance."),(0,o.yg)("p",null,"A Manager instance is in charge of the low-level connection to the server (established with HTTP long-polling or WebSocket). It handles the reconnection logic."),(0,o.yg)("p",null,"A Socket instance is the interface which is used to sends events to \u2014 and receive events from \u2014 the server. It belongs to a given ",(0,o.yg)("a",{parentName:"p",href:"/docs/v3/namespaces/"},"namespace"),"."),(0,o.yg)("p",null,"A single Manager can be attached to several Socket instances."),(0,o.yg)("p",null,"The following example will reuse the same Manager instance for the 3 Socket instances (one single WebSocket connection):"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},'const socket = io("https://example.com"); // the main namespace\nconst productSocket = io("https://example.com/product"); // the "product" namespace\nconst orderSocket = io("https://example.com/order"); // the "order" namespace\n')),(0,o.yg)("p",null,"The following example will create 3 different Manager instances (and thus 3 distinct WebSocket connections):"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},'const socket = io("https://example.com"); // the main namespace\nconst productSocket = io("https://example.com/product", { forceNew: true }); // the "product" namespace\nconst orderSocket = io("https://example.com/order", { forceNew: true }); // the "order" namespace\n')),(0,o.yg)("p",null,"Reusing an existing namespace will also create a new Manager each time:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},'const socket1 = io(); // 1st manager\nconst socket2 = io(); // 2nd manager\nconst socket3 = io("/admin"); // reuse the 1st manager\nconst socket4 = io("/admin"); // 3rd manager\n')),(0,o.yg)("h4",{id:"multiplex"},(0,o.yg)("inlineCode",{parentName:"h4"},"multiplex")),(0,o.yg)("p",null,"Default value: ",(0,o.yg)("inlineCode",{parentName:"p"},"true")),(0,o.yg)("p",null,"The opposite of ",(0,o.yg)("inlineCode",{parentName:"p"},"forceNew"),": whether to reuse an existing Manager instance."),(0,o.yg)("h3",{id:"low-level-engine-options"},"Low-level engine options"),(0,o.yg)("p",null,"Note: These settings will be shared by all Socket instances attached to the same Manager."),(0,o.yg)("h4",{id:"transports"},(0,o.yg)("inlineCode",{parentName:"h4"},"transports")),(0,o.yg)("p",null,"Default value: ",(0,o.yg)("inlineCode",{parentName:"p"},'["polling", "websocket"]')),(0,o.yg)("p",null,"The low-level connection to the Socket.IO server can either be established with:"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"HTTP long-polling: successive HTTP requests (",(0,o.yg)("inlineCode",{parentName:"li"},"POST")," for writing, ",(0,o.yg)("inlineCode",{parentName:"li"},"GET")," for reading)"),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"https://en.wikipedia.org/wiki/WebSocket"},"WebSocket"))),(0,o.yg)("p",null,"The following example disables the HTTP long-polling transport:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},'const socket = io("https://example.com", { transports: ["websocket"] });\n')),(0,o.yg)("p",null,"Note: in that case, sticky sessions are not required on the server side (more information ",(0,o.yg)("a",{parentName:"p",href:"/docs/v3/using-multiple-nodes/"},"here"),")."),(0,o.yg)("p",null,"By default, the HTTP long-polling connection is established first, and then an upgrade to WebSocket is attempted (explanation ",(0,o.yg)("a",{parentName:"p",href:"/docs/v3/how-it-works/#Upgrade-mechanism"},"here"),"). You can use WebSocket first with:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},'const socket = io("https://example.com", {\n  transports: ["websocket", "polling"] // use WebSocket first, if available\n});\n\nsocket.on("connect_error", () => {\n  // revert to classic upgrade\n  socket.io.opts.transports = ["polling", "websocket"];\n});\n')),(0,o.yg)("p",null,"One possible downside is that the validity of your ",(0,o.yg)("a",{parentName:"p",href:"/docs/v3/handling-cors/"},"CORS configuration")," will only be checked if the WebSocket connection fails to be established."),(0,o.yg)("h4",{id:"upgrade"},(0,o.yg)("inlineCode",{parentName:"h4"},"upgrade")),(0,o.yg)("p",null,"Default value: ",(0,o.yg)("inlineCode",{parentName:"p"},"true")),(0,o.yg)("p",null,"Whether the client should try to upgrade the transport from HTTP long-polling to something better."),(0,o.yg)("h4",{id:"rememberupgrade"},(0,o.yg)("inlineCode",{parentName:"h4"},"rememberUpgrade")),(0,o.yg)("p",null,"Default value: ",(0,o.yg)("inlineCode",{parentName:"p"},"false")),(0,o.yg)("p",null,"If true and if the previous WebSocket connection to the server succeeded, the connection attempt will bypass the normal upgrade process and will initially try WebSocket. A connection attempt following a transport error will use the normal upgrade process. It is recommended you turn this on only when using SSL/TLS connections, or if you know that your network does not block websockets."),(0,o.yg)("h4",{id:"path"},(0,o.yg)("inlineCode",{parentName:"h4"},"path")),(0,o.yg)("p",null,"Default value: ",(0,o.yg)("inlineCode",{parentName:"p"},"/socket.io/")),(0,o.yg)("p",null,"It is the name of the path that is captured on the server side."),(0,o.yg)("p",null,"The server and the client values must match (unless you are using a path-rewriting proxy in between):"),(0,o.yg)("p",null,(0,o.yg)("em",{parentName:"p"},"Client")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},'import { io } from "socket.io-client";\n\nconst socket = io("https://example.com", {\n  path: "/my-custom-path/"\n});\n')),(0,o.yg)("p",null,(0,o.yg)("em",{parentName:"p"},"Server")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},'const httpServer = require("http").createServer();\nconst io = require("socket.io")(httpServer, {\n  path: "/my-custom-path/"\n});\n')),(0,o.yg)("p",null,"Please note that this is different from the path in the URI, which represents the ",(0,o.yg)("a",{parentName:"p",href:"https://socket.io/docs/v3/namespaces/"},"Namespace"),"."),(0,o.yg)("p",null,"Example:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},'import { io } from "socket.io-client";\n\nconst socket = io("https://example.com/order", {\n  path: "/my-custom-path/"\n});\n')),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},'the Socket instance is attached to the "order" Namespace'),(0,o.yg)("li",{parentName:"ul"},"the HTTP requests will look like: ",(0,o.yg)("inlineCode",{parentName:"li"},"GET https://example.com/my-custom-path/?EIO=4&transport=polling&t=ML4jUwU"))),(0,o.yg)("h4",{id:"query"},(0,o.yg)("inlineCode",{parentName:"h4"},"query")),(0,o.yg)("p",null,"Default value: -"),(0,o.yg)("p",null,"Additional query parameters (then found in ",(0,o.yg)("inlineCode",{parentName:"p"},"socket.handshake.query")," object on the server-side)."),(0,o.yg)("p",null,"Example:"),(0,o.yg)("p",null,(0,o.yg)("em",{parentName:"p"},"Client")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},'import { io } from "socket.io-client";\n\nconst socket = io({\n  query: {\n    x: 42\n  }\n});\n')),(0,o.yg)("p",null,(0,o.yg)("em",{parentName:"p"},"Server")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},'io.on("connection", (socket) => {\n  console.log(socket.handshake.query); // prints { x: "42", EIO: "4", transport: "polling" }\n});\n')),(0,o.yg)("p",null,"The query parameters cannot be updated for the duration of the session, so changing the ",(0,o.yg)("inlineCode",{parentName:"p"},"query")," on the client-side will only be effective when the current session gets closed and a new one is created:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},'socket.io.on("reconnect_attempt", () => {\n  socket.io.opts.query.x++;\n});\n')),(0,o.yg)("p",null,"Note: the following query parameters are reserved and can't be used in your application:"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"EIO"),': the version of the protocol (currently, "4")'),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"transport"),': the transport name ("polling" or "websocket")'),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"sid"),": the session ID"),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"j"),": if the transport is polling but a JSONP response is required"),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"t"),": a hashed-timestamp used for cache-busting")),(0,o.yg)("h4",{id:"extraheaders"},(0,o.yg)("inlineCode",{parentName:"h4"},"extraHeaders")),(0,o.yg)("p",null,"Default value: -"),(0,o.yg)("p",null,"Additional headers (then found in ",(0,o.yg)("inlineCode",{parentName:"p"},"socket.handshake.headers")," object on the server-side)."),(0,o.yg)("p",null,"Example:"),(0,o.yg)("p",null,(0,o.yg)("em",{parentName:"p"},"Client")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},'import { io } from "socket.io-client";\n\nconst socket = io({\n  extraHeaders: {\n    "my-custom-header": "1234"\n  }\n});\n')),(0,o.yg)("p",null,(0,o.yg)("em",{parentName:"p"},"Server")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},'io.on("connection", (socket) => {\n  console.log(socket.handshake.headers); // an object containing "my-custom-header": "1234"\n});\n')),(0,o.yg)("p",null,"A few notes:"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"this will not work when using only WebSocket in a browser")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},'import { io } from "socket.io-client";\n\nconst socket = io({\n  transports: ["websocket"],\n  extraHeaders: {\n    "my-custom-header": "1234" // WARN: this will be ignored in a browser\n  }\n});\n')),(0,o.yg)("p",null,"This will work in Node.js or in React-Native though."),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"you can update the headers during a session, but it will not be reflected on the server-side (as the ",(0,o.yg)("inlineCode",{parentName:"li"},"socket.handshake.headers")," object contains the headers that were sent during the Socket.IO handshake).")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},"const socket = io({\n  extraHeaders: {\n    count: 0\n  }\n});\n\nsetInterval(() => {\n  socket.io.opts.extraHeaders.count++;\n}, 1000);\n")),(0,o.yg)("h4",{id:"withcredentials"},(0,o.yg)("inlineCode",{parentName:"h4"},"withCredentials")),(0,o.yg)("p",null,"Default value: ",(0,o.yg)("inlineCode",{parentName:"p"},"false")),(0,o.yg)("p",null,"Whether or not cross-site requests should made using credentials such as cookies, authorization headers or TLS client certificates. Setting ",(0,o.yg)("inlineCode",{parentName:"p"},"withCredentials")," has no effect on same-site requests."),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},'import { io } from "socket.io-client";\n\nconst socket = io({\n  withCredentials: true\n});\n')),(0,o.yg)("p",null,"Documentation:"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/withCredentials"},"XMLHttpRequest.withCredentials")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"/docs/v3/handling-cors/"},"Handling CORS"))),(0,o.yg)("h4",{id:"forcebase64"},(0,o.yg)("inlineCode",{parentName:"h4"},"forceBase64")),(0,o.yg)("p",null,"Default value: ",(0,o.yg)("inlineCode",{parentName:"p"},"false")),(0,o.yg)("p",null,"Whether to force base64 encoding for binary content sent over WebSocket (always enabled for HTTP long-polling)."),(0,o.yg)("h4",{id:"timestamprequests"},(0,o.yg)("inlineCode",{parentName:"h4"},"timestampRequests")),(0,o.yg)("p",null,"Default value: ",(0,o.yg)("inlineCode",{parentName:"p"},"true")),(0,o.yg)("p",null,"Whether to add the timestamp query param to each request (for cache busting)."),(0,o.yg)("h4",{id:"timestampparam"},(0,o.yg)("inlineCode",{parentName:"h4"},"timestampParam")),(0,o.yg)("p",null,"Default value: ",(0,o.yg)("inlineCode",{parentName:"p"},'"t"')),(0,o.yg)("p",null,"The name of the query parameter to use as our timestamp key."),(0,o.yg)("h4",{id:"nodejs-specific-options"},"Node.js-specific options"),(0,o.yg)("p",null,"The following options are supported:"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"agent")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"pfx")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"key")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"passphrase")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"cert")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"ca")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"ciphers")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"rejectUnauthorized"))),(0,o.yg)("p",null,"Please refer to the Node.js documentation:"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"https://nodejs.org/dist/latest/docs/api/tls.html#tls_tls_connect_options_callback"},"tls.connect(options[, callback])")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"https://nodejs.org/dist/latest/docs/api/tls.html#tls_tls_createsecurecontext_options"},"tls.createSecureContext([options])"))),(0,o.yg)("p",null,"Example with a self-signed certificate:"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"Client")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},'const fs = require("fs");\nconst socket = require("socket.io-client")("https://example.com", {\n  ca: fs.readFileSync("./cert.pem")\n});\n')),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"Server")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},'const fs = require("fs");\nconst server = require("https").createServer({\n  cert: fs.readFileSync("./cert.pem"),\n  key: fs.readFileSync("./key.pem")\n});\nconst io = require("socket.io")(server);\n')),(0,o.yg)("p",null,"Example with client-certificate authentication:"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"Client")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},'const fs = require("fs");\nconst socket = require("socket.io-client")("https://example.com", {\n  ca: fs.readFileSync("./server-cert.pem"),\n  cert: fs.readFileSync("./client-cert.pem"),\n  key: fs.readFileSync("./client-key.pem"),\n});\n')),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"Server")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},'const fs = require("fs");\nconst server = require("https").createServer({\n  cert: fs.readFileSync("./server-cert.pem"),\n  key: fs.readFileSync("./server-key.pem"),\n  requestCert: true,\n  ca: [\n    fs.readFileSync(\'client-cert.pem\')\n  ]\n});\nconst io = require("socket.io")(server);\n')),(0,o.yg)("p",null,(0,o.yg)("strong",{parentName:"p"},"Import note:")," ",(0,o.yg)("inlineCode",{parentName:"p"},"rejectUnauthorized")," is a Node.js-only option, it will not bypass the security check in the browser:"),(0,o.yg)("p",null,(0,o.yg)("img",{alt:"Security warning in the browser",src:t(3959).A,width:"1003",height:"581"})),(0,o.yg)("h3",{id:"manager-options"},"Manager options"),(0,o.yg)("p",null,"Note: These settings will be shared by all Socket instances attached to the same Manager."),(0,o.yg)("h4",{id:"reconnection"},"reconnection"),(0,o.yg)("p",null,"Default value: ",(0,o.yg)("inlineCode",{parentName:"p"},"true")),(0,o.yg)("p",null,"Whether reconnection is enabled or not. If set to ",(0,o.yg)("inlineCode",{parentName:"p"},"false"),", you need to manually reconnect:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},'import { io } from "socket.io-client";\n\nconst socket = io({\n  reconnection: false\n});\n\nconst tryReconnect = () => {\n  setTimeout(() => {\n    socket.io.open((err) => {\n      if (err) {\n        tryReconnect();\n      }\n    });\n  }, 2000);\n}\n\nsocket.io.on("close", tryReconnect);\n')),(0,o.yg)("h4",{id:"reconnectionattempts"},"reconnectionAttempts"),(0,o.yg)("p",null,"Default value: ",(0,o.yg)("inlineCode",{parentName:"p"},"Infinity")),(0,o.yg)("p",null,"The number of reconnection attempts before giving up."),(0,o.yg)("h4",{id:"reconnectiondelay"},"reconnectionDelay"),(0,o.yg)("p",null,"Default value: ",(0,o.yg)("inlineCode",{parentName:"p"},"1000")),(0,o.yg)("p",null,"The initial delay before reconnection in milliseconds (affected by the ",(0,o.yg)("a",{parentName:"p",href:"#randomizationFactor"},"randomizationFactor")," value)."),(0,o.yg)("h4",{id:"reconnectiondelaymax"},"reconnectionDelayMax"),(0,o.yg)("p",null,"Default value: ",(0,o.yg)("inlineCode",{parentName:"p"},"5000")),(0,o.yg)("p",null,"The maximum delay between two reconnection attempts. Each attempt increases the reconnection delay by 2x."),(0,o.yg)("h4",{id:"randomizationfactor"},"randomizationFactor"),(0,o.yg)("p",null,"Default value: ",(0,o.yg)("inlineCode",{parentName:"p"},"0.5")),(0,o.yg)("p",null,"The randomization factor used when reconnecting (so that the clients do not reconnect at the exact same time after a server crash, for example)."),(0,o.yg)("p",null,"Example with the default values:"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"1st reconnection attempt happens between 500 and 1500 ms (",(0,o.yg)("inlineCode",{parentName:"li"},"1000 * 2^0 * (<something between -0.5 and 1.5>)"),")"),(0,o.yg)("li",{parentName:"ul"},"2nd reconnection attempt happens between 1000 and 3000 ms (",(0,o.yg)("inlineCode",{parentName:"li"},"1000 * 2^1 * (<something between -0.5 and 1.5>)"),")"),(0,o.yg)("li",{parentName:"ul"},"3rd reconnection attempt happens between 2000 and 5000 ms (",(0,o.yg)("inlineCode",{parentName:"li"},"1000 * 2^2 * (<something between -0.5 and 1.5>)"),")"),(0,o.yg)("li",{parentName:"ul"},"next reconnection attempts happen after 5000 ms")),(0,o.yg)("h4",{id:"timeout"},"timeout"),(0,o.yg)("p",null,"Default value: ",(0,o.yg)("inlineCode",{parentName:"p"},"20000")),(0,o.yg)("p",null,"The timeout in milliseconds for each connection attempt."),(0,o.yg)("h4",{id:"autoconnect"},"autoConnect"),(0,o.yg)("p",null,"Default value: ",(0,o.yg)("inlineCode",{parentName:"p"},"true")),(0,o.yg)("p",null,"Whether to automatically connect upon creation. If set to ",(0,o.yg)("inlineCode",{parentName:"p"},"false"),", you need to manually connect:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},'import { io } from "socket.io-client";\n\nconst socket = io({\n  autoConnect: false\n});\n\nsocket.connect();\n// or\nsocket.io.open();\n')),(0,o.yg)("h4",{id:"parser"},(0,o.yg)("inlineCode",{parentName:"h4"},"parser")),(0,o.yg)("p",null,"Added in v2.2.0"),(0,o.yg)("p",null,"Default value: ",(0,o.yg)("inlineCode",{parentName:"p"},'require("socket.io-parser")')),(0,o.yg)("p",null,"The parser used to marshall/unmarshall packets. Please see ",(0,o.yg)("a",{parentName:"p",href:"/docs/v3/custom-parser/"},"here")," for more information."),(0,o.yg)("h3",{id:"socket-options"},"Socket options"),(0,o.yg)("p",null,"Note: These settings are specific to the given Socket instance."),(0,o.yg)("h4",{id:"auth"},(0,o.yg)("inlineCode",{parentName:"h4"},"auth")),(0,o.yg)("p",null,"Added in v3.0.0"),(0,o.yg)("p",null,"Default value: -"),(0,o.yg)("p",null,"Credentials that are sent when accessing a namespace (see also ",(0,o.yg)("a",{parentName:"p",href:"/docs/v3/middlewares/#Sending-credentials"},"here"),")."),(0,o.yg)("p",null,"Example:"),(0,o.yg)("p",null,(0,o.yg)("em",{parentName:"p"},"Client")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},'import { io } from "socket.io-client";\n\nconst socket = io({\n  auth: {\n    token: "abcd"\n  }\n});\n')),(0,o.yg)("p",null,(0,o.yg)("em",{parentName:"p"},"Server")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},'io.on("connection", (socket) => {\n  console.log(socket.handshake.auth); // prints { token: "abcd" }\n});\n')),(0,o.yg)("p",null,"You can update the ",(0,o.yg)("inlineCode",{parentName:"p"},"auth")," map when the access to the Namespace is denied:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},'socket.on("connect_error", (err) => {\n  if (err.message === "invalid credentials") {\n    socket.auth.token = "efgh";\n    socket.connect();\n  }\n});\n')),(0,o.yg)("p",null,"Or manually force the Socket instance to reconnect:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},'socket.auth.token = "efgh";\nsocket.disconnect().connect();\n')))}g.isMDXComponent=!0},3959:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/self-signed-certificate-a0d2f0b33ea47a62c960fcb5a98cd534.png"}}]);